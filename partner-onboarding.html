<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="TR ONESOURCE Partner Onboarding - Generate your personalized implementation guide">
    <title>Partner Onboarding | TR ONESOURCE E-Invoicing</title>

    <!-- Dark Mode Detection -->
    <script>
        (function() {
            const cl = document.documentElement.classList;
            const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
            if (prefersDark) {
                cl.add('dark');
            }
        })();
    </script>

    <!-- Styles -->
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="assets/css/layout.css">
    <link rel="stylesheet" href="assets/css/components.css">
    <link rel="stylesheet" href="assets/css/chatbot.css">
    <link rel="stylesheet" href="assets/css/partner-onboarding.css">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Signup Styles -->
    <link rel="stylesheet" href="assets/css/signup.css">
</head>
<body>
    <!-- Fixed Header -->
    <header class="site-header">
        <!-- Mobile Header (< 1024px) -->
        <div class="mobile-header-wrapper">
            <div style="display: flex; align-items: center; gap: 1rem;">
                <button class="mobile-menu-toggle" aria-label="Toggle navigation menu">
                    <i class="fas fa-bars"></i>
                </button>
                <a href="index.html" class="mobile-brand">
                    <div class="mobile-logo-box">
                        <span class="mobile-logo-text">TR</span>
                    </div>
                    <span class="mobile-brand-text">ONESOURCE</span>
                </a>
            </div>
            <a href="index.html" class="mobile-doc-link">Documentation</a>
        </div>

        <!-- Desktop Header (>= 1024px) -->
        <div class="container" style="display: flex; align-items: center; justify-content: space-between; height: 100%; padding: 0 1.5rem;">
            <div style="display: flex; align-items: center; gap: 1rem;">
                <a href="index.html" class="navbar-brand navbar-brand-desktop" style="display: flex; align-items: center; gap: 1rem; text-decoration: none;">
                    <div style="background-color: white; padding: 6px 12px; border-radius: 6px; display: flex; align-items: center; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);">
                        <img src="assets/images/Thomson-Reuters-Logo-500x281.png" alt="Thomson Reuters" style="height: 32px; width: auto; display: block;">
                    </div>
                </a>
            </div>
            <div style="display: flex; align-items: center; gap: 1rem;">
                <button id="viewPastReportsBtn" class="header-ai-button" aria-label="View Past Reports">
                    <i class="fas fa-history"></i>
                    <span class="ai-button-text">Past Reports</span>
                </button>
                <button id="headerAIButton" class="header-ai-button" aria-label="Open AI Assistant">
                    <i class="fas fa-robot"></i>
                    <span class="ai-button-text">AI Assistant</span>
                </button>
                <button id="logoutButton" class="header-ai-button" aria-label="Logout" style="display: none;">
                    <i class="fas fa-sign-out-alt"></i>
                    <span class="ai-button-text">Logout</span>
                </button>
            </div>
        </div>
    </header>

    <!-- Overlay for mobile sidebar -->
    <div class="sidebar-overlay"></div>

    <!-- Main Container -->
    <div id="retype-container">
        <!-- Left Sidebar Navigation -->
        <aside class="sidebar-left">
            <nav class="sidebar-nav">
                <!-- Home Section -->
                <div class="nav-section">
                    <a href="index.html" class="nav-section-title" style="text-decoration: none;">
                        <span><i class="fas fa-home" style="margin-right: 0.5rem; width: 20px;"></i> Home</span>
                    </a>
                </div>

                <!-- Getting Started Section -->
                <div class="nav-section">
                    <a href="getting-started.html" class="nav-section-title" style="text-decoration: none;">
                        <span><i class="fas fa-rocket" style="margin-right: 0.5rem; width: 20px;"></i> Getting Started</span>
                    </a>
                </div>

                <!-- E-Invoicing Integration Section -->
                <div class="nav-section">
                    <a href="einvoicing-integration.html" class="nav-section-title" style="text-decoration: none;">
                        <span><i class="fas fa-file-invoice" style="margin-right: 0.5rem; width: 20px;"></i> E-Invoicing Integration</span>
                    </a>
                </div>

                <!-- API Reference Section -->
                <div class="nav-section">
                    <a href="api-reference.html" class="nav-section-title" style="text-decoration: none;">
                        <span><i class="fas fa-code" style="margin-right: 0.5rem; width: 20px;"></i> API Reference</span>
                    </a>
                </div>

                <!-- Partner Onboarding Section (Active) -->
                <div class="nav-section">
                    <a href="partner-onboarding.html" class="nav-section-title active" style="text-decoration: none;">
                        <span><i class="fas fa-handshake" style="margin-right: 0.5rem; width: 20px;"></i> Partner Onboarding</span>
                    </a>
                </div>

                <!-- FAQ Section -->
                <div class="nav-section">
                    <a href="faq.html" class="nav-section-title" style="text-decoration: none;">
                        <span><i class="fas fa-question-circle" style="margin-right: 0.5rem; width: 20px;"></i> FAQ</span>
                    </a>
                </div>
            </nav>
        </aside>

        <!-- Main Content Area -->
        <div class="main-wrapper">
            <main class="main-content-area">
                <!-- Page Header -->
                <div class="page-header">
                    <h1><i class="fas fa-handshake"></i> Partner Onboarding</h1>
                    <p class="subtitle">Complete this form to generate your personalized implementation guide powered by our enhanced AI multi-agent system (v2.1)</p>
                </div>

                <!-- Profile Summary Card (shown only for logged-in users) -->
                <div id="profileSummary" class="profile-summary" style="display: none;">
                    <div class="profile-summary-header">
                        <h3><i class="fas fa-user-check"></i> Your Profile</h3>
                        <a href="signup-form.html?mode=edit" class="btn btn-secondary btn-sm">
                            <i class="fas fa-edit"></i> Edit Profile
                        </a>
                    </div>
                    <p class="profile-summary-message">Your profile information has been pre-filled. Just select the countries below to generate your report.</p>
                    <details class="profile-details">
                        <summary>View Profile Details</summary>
                        <div class="profile-details-content" id="profileDetailsContent">
                            <!-- Populated by JavaScript -->
                        </div>
                    </details>
                </div>

                <!-- Main Form -->
                <div id="formContainer" class="onboarding-form-container">
                    <form id="onboardingForm" novalidate>
                        <!-- Section 1: Partner & Contact Information -->
                        <div class="form-section" id="section-partner-contact">
                            <h2><i class="fas fa-building"></i> Partner & Contact Information</h2>

                            <div class="form-group">
                                <label for="partnerCompanyName">Partner Company Name</label>
                                <input type="text" id="partnerCompanyName" name="partnerCompanyName" placeholder="Enter your company name">
                                <span class="error-message"></span>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="projectManagerName">Project Manager Name</label>
                                    <input type="text" id="projectManagerName" name="projectManagerName" placeholder="Full name">
                                    <span class="error-message"></span>
                                </div>
                                <div class="form-group">
                                    <label for="projectManagerEmail">Project Manager Email</label>
                                    <input type="email" id="projectManagerEmail" name="projectManagerEmail" placeholder="email@company.com">
                                    <span class="error-message"></span>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="technicalLeadName">Technical Lead/Developer Name</label>
                                    <input type="text" id="technicalLeadName" name="technicalLeadName" placeholder="Full name">
                                    <span class="error-message"></span>
                                </div>
                                <div class="form-group">
                                    <label for="technicalLeadEmail">Technical Lead/Developer Email</label>
                                    <input type="email" id="technicalLeadEmail" name="technicalLeadEmail" placeholder="email@company.com">
                                    <span class="error-message"></span>
                                </div>
                            </div>
                        </div>

                        <!-- Section 2: Partnership Type -->
                        <div class="form-section" id="section-partnership-type">
                            <h2><i class="fas fa-users"></i> Partnership Type</h2>
                            <div class="form-group radio-group">
                                <label>Select Partnership Type</label>
                                <div class="radio-options">
                                    <label class="radio-label">
                                        <input type="radio" name="partnershipType" value="reseller">
                                        <span class="radio-text">
                                            <strong>Reseller Partner</strong>
                                            <small>You sell and support TR ONESOURCE to end customers</small>
                                        </span>
                                    </label>
                                    <label class="radio-label">
                                        <input type="radio" name="partnershipType" value="referral">
                                        <span class="radio-text">
                                            <strong>Referral Partner</strong>
                                            <small>You refer customers to Thomson Reuters</small>
                                        </span>
                                    </label>
                                </div>
                                <span class="error-message"></span>
                            </div>
                        </div>

                        <!-- Section 3: System Integration -->
                        <div class="form-section" id="section-system-integration">
                            <h2><i class="fas fa-plug"></i> System Integration</h2>

                            <div class="form-group">
                                <label for="programmingLanguage">Primary Programming Language</label>
                                <select id="programmingLanguage" name="programmingLanguage">
                                    <option value="">Select programming language...</option>
                                    <option value="python">Python</option>
                                    <option value="javascript">JavaScript / Node.js</option>
                                    <option value="java">Java</option>
                                    <option value="csharp">C# / .NET</option>
                                    <option value="php">PHP</option>
                                    <option value="ruby">Ruby</option>
                                    <option value="go">Go</option>
                                    <option value="other">Other</option>
                                </select>
                                <small style="color: var(--color-gray); margin-top: 0.5rem; display: block;">Code examples in the report will use this language (except PUF XML which uses UBL XML format)</small>
                                <span class="error-message"></span>
                            </div>

                            <div class="form-group checkbox-group">
                                <label>Select Systems to Integrate (select all that apply)</label>
                                <div class="checkbox-options">
                                    <label class="checkbox-label">
                                        <input type="checkbox" name="systemIntegration" value="erp" id="systemErp">
                                        <span class="checkbox-text">
                                            <strong>ERP System</strong>
                                            <small>Enterprise Resource Planning</small>
                                        </span>
                                    </label>
                                    <div class="conditional-input" id="erpDetails" style="display: none;">
                                        <input type="text" name="erpDetails" placeholder="Specify ERP name & version (e.g., SAP S/4HANA 2021)">
                                    </div>

                                    <label class="checkbox-label">
                                        <input type="checkbox" name="systemIntegration" value="tax">
                                        <span class="checkbox-text">
                                            <strong>Tax Technology Platform</strong>
                                            <small>Tax calculation and compliance systems</small>
                                        </span>
                                    </label>

                                    <label class="checkbox-label">
                                        <input type="checkbox" name="systemIntegration" value="workflow">
                                        <span class="checkbox-text">
                                            <strong>Workflow/Approval System</strong>
                                            <small>Document approval and routing</small>
                                        </span>
                                    </label>

                                    <label class="checkbox-label">
                                        <input type="checkbox" name="systemIntegration" value="procurement">
                                        <span class="checkbox-text">
                                            <strong>Procurement Platform</strong>
                                            <small>Purchase order and procurement systems</small>
                                        </span>
                                    </label>

                                    <label class="checkbox-label">
                                        <input type="checkbox" name="systemIntegration" value="custom">
                                        <span class="checkbox-text">
                                            <strong>Custom-built System</strong>
                                            <small>Proprietary or internally developed systems</small>
                                        </span>
                                    </label>

                                    <label class="checkbox-label">
                                        <input type="checkbox" name="systemIntegration" value="other" id="systemOther">
                                        <span class="checkbox-text">
                                            <strong>Other</strong>
                                            <small>Other system types</small>
                                        </span>
                                    </label>
                                    <div class="conditional-input" id="otherSystemDetails" style="display: none;">
                                        <input type="text" name="otherSystemDetails" placeholder="Please specify the system type">
                                    </div>
                                </div>
                                <span class="error-message"></span>
                            </div>
                        </div>

                        <!-- Section 4: Countries in Scope (Full Form) -->
                        <div class="form-section" id="countriesFullSection">
                            <h2><i class="fas fa-globe"></i> Countries in Scope</h2>

                            <div class="form-group">
                                <label for="country1" class="required">Country 1 (Priority)</label>
                                <input type="text" id="country1" name="country1" required placeholder="e.g., Germany, France, Italy" list="countryList">
                                <datalist id="countryList">
                                    <option value="Germany">
                                    <option value="France">
                                    <option value="Italy">
                                    <option value="Spain">
                                    <option value="Poland">
                                    <option value="Romania">
                                    <option value="Belgium">
                                    <option value="Netherlands">
                                    <option value="Portugal">
                                    <option value="Brazil">
                                    <option value="Mexico">
                                    <option value="United States">
                                </datalist>
                                <span class="error-message"></span>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="country2">Country 2 (Optional)</label>
                                    <input type="text" id="country2" name="country2" placeholder="Additional country" list="countryList">
                                </div>
                                <div class="form-group">
                                    <label for="country3">Country 3 (Optional)</label>
                                    <input type="text" id="country3" name="country3" placeholder="Additional country" list="countryList">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="additionalCountries">Additional Countries (Optional)</label>
                                <textarea id="additionalCountries" name="additionalCountries" rows="3" placeholder="Enter any additional countries, separated by commas"></textarea>
                            </div>
                        </div>

                        <!-- Section 4: Countries in Scope (Simplified for Logged-In Users) -->
                        <div class="form-section" id="countriesSimplifiedSection" style="display: none;">
                            <h2><i class="fas fa-globe"></i> Countries for Report</h2>
                            <div class="form-group">
                                <label for="countriesSimplified" class="required">Countries (comma-separated)</label>
                                <input
                                    type="text"
                                    id="countriesSimplified"
                                    name="countriesSimplified"
                                    placeholder="e.g., Germany, France, Italy, Spain"
                                    list="countryList"
                                    required
                                />
                                <small style="color: var(--color-gray); margin-top: 0.5rem; display: block;">
                                    Enter multiple countries separated by commas
                                </small>
                                <span class="error-message"></span>
                            </div>
                        </div>

                        <!-- Section 5: AP/AR Handling -->
                        <div class="form-section" id="section-ap-ar">
                            <h2><i class="fas fa-file-invoice-dollar"></i> AP/AR Handling</h2>

                            <div class="form-group checkbox-group">
                                <label>Select Invoice Handling Type (select all that apply)</label>
                                <div class="checkbox-options">
                                    <label class="checkbox-label">
                                        <input type="checkbox" name="invoiceHandling" value="ar">
                                        <span class="checkbox-text">
                                            <strong>Accounts Receivable (AR)</strong>
                                            <small>Sending invoices to customers</small>
                                        </span>
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" name="invoiceHandling" value="ap">
                                        <span class="checkbox-text">
                                            <strong>Accounts Payable (AP)</strong>
                                            <small>Receiving invoices from suppliers</small>
                                        </span>
                                    </label>
                                </div>
                                <span class="error-message"></span>
                            </div>

                            <div class="form-group">
                                <label for="invoiceVolume">Estimated Monthly Invoice Volume</label>
                                <input type="number" id="invoiceVolume" name="invoiceVolume" min="1" placeholder="Enter estimated number of invoices per month">
                                <span class="error-message"></span>
                            </div>
                        </div>

                        <!-- Section 6: First-Line Support -->
                        <div class="form-section" id="section-first-line-support">
                            <h2><i class="fas fa-headset"></i> First-Line Support</h2>
                            <div class="form-group radio-group">
                                <label>Who will provide first-line support to end customers?</label>
                                <div class="radio-options">
                                    <label class="radio-label">
                                        <input type="radio" name="firstLineSupport" value="thomson-reuters">
                                        <span class="radio-text">
                                            <strong>Thomson Reuters</strong>
                                            <small>TR provides direct support to end customers</small>
                                        </span>
                                    </label>
                                    <label class="radio-label">
                                        <input type="radio" name="firstLineSupport" value="partner">
                                        <span class="radio-text">
                                            <strong>Partner</strong>
                                            <small>Partner provides first-line support, escalates to TR as needed</small>
                                        </span>
                                    </label>
                                </div>
                                <span class="error-message"></span>
                            </div>
                        </div>

                        <!-- Section 7: Account Access Management -->
                        <div class="form-section" id="section-account-access">
                            <h2><i class="fas fa-key"></i> Account Access Management</h2>
                            <div class="form-group radio-group">
                                <label>How will customer accounts be managed?</label>
                                <div class="radio-options">
                                    <label class="radio-label">
                                        <input type="radio" name="accountAccess" value="partner-managed">
                                        <span class="radio-text">
                                            <strong>Partner manages all customer accounts</strong>
                                            <small>Partner has master credentials and manages sub-accounts</small>
                                        </span>
                                    </label>
                                    <label class="radio-label">
                                        <input type="radio" name="accountAccess" value="customer-direct">
                                        <span class="radio-text">
                                            <strong>End customers have direct access</strong>
                                            <small>Each customer has their own credentials and portal access</small>
                                        </span>
                                    </label>
                                </div>
                                <span class="error-message"></span>
                            </div>
                        </div>

                        <!-- Section 8: Service Model -->
                        <div class="form-section" id="section-service-model">
                            <h2><i class="fas fa-cogs"></i> Service Model</h2>
                            <div class="form-group radio-group">
                                <label>Select Your Service Model</label>
                                <div class="radio-options">
                                    <label class="radio-label">
                                        <input type="radio" name="serviceModel" value="self-service">
                                        <span class="radio-text">
                                            <strong>Self-Service</strong>
                                            <small>Partner manages implementation and operations independently</small>
                                        </span>
                                    </label>
                                    <label class="radio-label">
                                        <input type="radio" name="serviceModel" value="managed-service">
                                        <span class="radio-text">
                                            <strong>Managed Service</strong>
                                            <small>Thomson Reuters provides ongoing support and guidance</small>
                                        </span>
                                    </label>
                                </div>
                                <span class="error-message"></span>
                            </div>
                        </div>

                        <!-- Form Actions -->
                        <div class="form-actions">
                            <button type="button" id="clearBtn" class="btn btn-secondary">
                                <i class="fas fa-eraser"></i> Clear Form
                            </button>
                            <button type="submit" id="submitBtn" class="btn btn-primary" disabled>
                                <i class="fas fa-paper-plane"></i> Generate Report
                            </button>
                        </div>

                        <!-- Auto-save indicator -->
                        <div class="auto-save-indicator" id="autoSaveIndicator">
                            <i class="fas fa-check-circle"></i> Form auto-saved
                        </div>

                        <!-- Demo Mode Toggle -->
                        <div class="demo-mode-toggle">
                            <label>
                                <input type="checkbox" id="demoModeToggle">
                                <span>Demo Mode (Use mock data without API token)</span>
                            </label>
                        </div>
                    </form>
                </div>

                <!-- Loading Spinner -->
                <div id="loadingSpinner" class="loading-spinner" style="display: none;">
                    <div class="spinner"></div>
                    <p>Generating your implementation report...</p>
                    <small>Phase 1: Analyzing country compliance requirements (CCR Agents)</small>
                    <small>Phase 2: Generating format specifications (Format Agents)</small>
                    <small>Phase 3: Creating API implementation code (API Agent)</small>
                    <small id="loadingTimeEstimate" style="margin-top: 10px; font-weight: 600;">This may take 3-5 minutes for multi-country reports...</small>
                </div>

                <!-- Report Display -->
                <div id="reportContainer" class="report-container" style="display: none;">
                    <div class="report-header">
                        <h2><i class="fas fa-file-alt"></i> Partner Implementation Report</h2>
                        <div class="report-actions">
                            <button type="button" id="printReportBtn" class="btn btn-secondary btn-sm">
                                <i class="fas fa-print"></i> Print
                            </button>
                            <button type="button" id="copyReportBtn" class="btn btn-secondary btn-sm">
                                <i class="fas fa-copy"></i> Copy
                            </button>
                            <button type="button" id="newFormBtn" class="btn btn-primary btn-sm">
                                <i class="fas fa-plus"></i> New Form
                            </button>
                        </div>
                    </div>
                    <div id="reportContent" class="report-content"></div>
                </div>

                <!-- Footer -->
                <footer class="site-footer">
                    <p>Â© 2025 Thomson Reuters. All rights reserved.</p>
                </footer>
            </main>
        </div>

        <!-- Right Sidebar (Table of Contents) -->
        <aside class="sidebar-right">
            <!-- Form TOC (shown by default, manually populated) -->
            <div class="toc-container form-toc">
                <div class="toc-title">Form Sections</div>
                <ul class="form-toc-list">
                    <li><a href="#profileSummary">Your Profile</a></li>
                    <li><a href="#countriesSimplifiedSection">Countries for Report</a></li>
                </ul>
            </div>

            <!-- Report TOC (shown when report is generated, populated by partner-onboarding.js) -->
            <div class="toc-container report-toc" style="display: none;">
                <div class="toc-title">Report Contents</div>
                <ul class="report-toc-list" id="reportTocList">
                    <!-- Populated dynamically by partner-onboarding.js based on generated report -->
                    <!-- Structure from report-template-config-v2.1.json:
                        1. Executive Summary (auto-generated)
                        2. Country Compliance Requirements: {country} (CCR Agent - per country)
                        3. Document Format Details: {country} (Format Agent - per country)
                        4. API Implementation Guide (API Agent - all countries aggregated)

                        v2.1 Changes:
                        - Removed: Testing & Validation (static section)
                        - Removed: Production Deployment (static section)
                        - Removed: Support & Resources (static section)
                        - Focus on agent-generated, customized content only
                    -->
                </ul>
            </div>
        </aside>
    </div>

    <!-- API Key Modal -->
    <div id="apiKeyModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Configure API Settings</h3>
                <button class="modal-close" id="modalCloseBtn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <p>To generate reports, please enter your TR OpenArena API Token:</p>
                <div class="modal-warning">
                    <strong>Note:</strong> Your credentials are stored in your browser session only.
                </div>
                <div class="form-group">
                    <label for="apiTokenInput">API Token (ESSO):</label>
                    <input type="password" id="apiTokenInput" placeholder="Enter your TR OpenArena API token" autocomplete="off">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="modalCancelBtn">Cancel</button>
                <button class="btn btn-primary" id="modalSaveBtn">Save & Continue</button>
            </div>
        </div>
    </div>

    <!-- Past Reports Modal -->
    <div id="pastReportsModal" class="modal">
        <div class="modal-content past-reports-modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-history"></i> Past Reports</h3>
                <button class="modal-close" id="pastReportsModalClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body past-reports-body">
                <div id="pastReportsList" class="past-reports-list">
                    <!-- Populated dynamically by JavaScript -->
                </div>
                <div id="pastReportsEmpty" class="past-reports-empty" style="display: none;">
                    <i class="fas fa-inbox"></i>
                    <p>No past reports found</p>
                    <small>Generate your first report using the form</small>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="clearAllReportsBtn">
                    <i class="fas fa-trash"></i> Clear All Reports
                </button>
                <button class="btn btn-primary" id="pastReportsModalCloseBtn">Close</button>
            </div>
        </div>
    </div>

    <!-- Chatbot Container -->
    <div id="chatbot-container"></div>

    <!-- Scripts -->
    <script src="assets/js/theme-toggle.js"></script>
    <script src="assets/js/layout.js"></script>
    <script src="assets/js/navigation.js"></script>
    <script src="assets/js/chatbot-ui.js"></script>
    <script src="assets/js/openarena-client.js"></script>
    <script src="assets/js/report-context-manager.js"></script>
    <script src="assets/js/supervisor-agent.js"></script>
    <script src="assets/js/chatbot-controller.js"></script>
    <script src="assets/js/partner-onboarding.js"></script>
</body>
</html>
